BorFileListFromDB:SELECT DISTINCT BORFILESUBLIST.GRPID,BORFILESUBLIST.SUBGRPID,BORFILESUBLIST.SUBID,BORFILESUBLIST.MEMSFX,BORFILESUBLIST.PLANID,BORFILESUBLIST.PRDID,BORFILESUBLIST.PRDCAT, BORFILESUBLIST.CLASSID,BORFILESUBLIST.PRDBUSCAT,BORFILESUBLIST.PRDVALCD,BORFILESUBLIST.LOBDID,BORFILESUBLIST.LOBDTYPE FROM  ( SELECT DISTINCT GRGR.GRGR_ID AS GRPID,SGSG.SGSG_ID AS SUBGRPID,SBSB.SBSB_ID AS SUBID,MEME.MEME_SFX AS MEMSFX,MEPE.CSPI_ID AS PLANID ,MEPE.PDPD_ID AS PRDID, MEPE.CSPD_CAT AS PRDCAT,MEPE.CSCS_ID AS CLASSID,PDDS.PDDS_MCTR_BCAT AS PRDBUSCAT,PDDS.PDDS_MCTR_VAL1 AS PRDVALCD,PDPD.LOBD_ID AS LOBDID,LOBD.LOBD_MCTR_TYPE AS LOBDTYPE ,ROW_NUMBER() OVER (PARTITION BY GRGR.GRGR_CK ORDER BY SBSB.SBSB_CK DESC) as ROW_NUM1  FROM FC_CMC_GRGR_GROUP GRGR INNER JOIN FC_CMC_SBSB_SUBSC SBSB ON GRGR.GRGR_CK=SBSB.GRGR_CK INNER JOIN FC_CMC_MEME_MEMBER MEME ON SBSB.SBSB_CK=MEME.SBSB_CK INNER JOIN FC_CMC_MEPE_PRCS_ELIG MEPE ON MEME.MEME_CK=MEPE.MEME_CK AND MEPE.MEPE_TERM_DT > SYSDATE and MEPE.MEPE_ELIG_IND ='Y' AND MEPE.CSPD_CAT='M'  INNER JOIN FC_CMC_PDPD_PRODUCT PDPD ON MEPE.PDPD_ID=PDPD.PDPD_ID AND PDPD.LOBD_ID='0006' INNER JOIN FC_CMC_PDDS_PROD_DESC PDDS ON PDPD.PDPD_ID=PDDS.PDPD_ID AND PDDS.PDDS_MCTR_BCAT NOT IN ('0025') INNER JOIN FC_CMC_LOBD_LINE_BUS LOBD ON PDPD.LOBD_ID=LOBD.LOBD_ID  INNER JOIN FC_CMC_PDBC_PROD_COMP PDBC ON PDPD.PDPD_ID=PDDS.PDPD_ID AND PDBC_TYPE='BSBS' INNER JOIN FC_CMC_BSDL_DETAILS BSDL ON PDBC.PDBC_PFX=BSDL.PDBC_PFX AND BSDL_TYPE IN ('PRBM','PRGM') INNER JOIN FC_CMC_SGSG_SUB_GROUP SGSG ON GRGR.GRGR_CK=SGSG.GRGR_CK WHERE GRGR.GRGR_CK IN ( SELECT DISTINCT AFEP.GRGR_CK FROM FC_CMC_AFEP_ENTY_PLAN AFEP  INNER JOIN FC_CMC_AFCP_CONT_PER AFCP ON AFEP.AFAI_CK=AFCP.AFAI_CK  INNER JOIN FC_CMC_AFAI_INDIC AFAI ON AFEP.AFAI_CK=AFAI.AFAI_CK AND AFAI_MCTR_TYPE='F001' WHERE AFCP.AFCP_PAID_END_DT > SYSDATE AND AFCP_INCUR_END_DT > SYSDATE FETCH FIRST 25 ROWS ONLY )) BORFILESUBLIST WHERE ROW_NUM1 = 1 FETCH FIRST 5 ROWS ONLY
BorAdjustmentRecords:SELECT * FROM (SELECT DISTINCT FICT_CLM_ID, FIL_NM, VEND_NM, GRP_NBR, SBGRP_ID, SBSCR_ID, PERS_NBR, CLM_NBR, CLM_VER_NBR, CLM_AMT, CLI_PRC_AMT, BSC_RVNU_AMT, CHK_NBR, CHK_DT, SVC_DT, PAYE_ID, PAYE_NM, PLN_ID, PRDCT_ID, PRDCT_CATEG_CD, CLS_ID,PRDCT_BUS_CATEG_CD, PRDCT_VAL1_CD, LOB_ID, LGL_ENTY_CD, BIL_AMT, ALLOW_AMT, DED_AMT, COINS_AMT, COPAY_AMT, DIAG_CD, DIAG_TYP_CD, PROC_CD, HCPCS_ID, CLM_TRANS_TYP_CD ,ROW_NUMBER() OVER (PARTITION BY BLXP.GRGR_CK ORDER BY BLXP.SBSB_CK, BOR.LOAD_DTTM  DESC) as ROW_NUM1  FROM FACETS_CUSTOM.ARGUS_GL_BOR_FIL_HIST BOR INNER JOIN FC_CMC_BLXP_EXT_PYMT BLXP ON BOR.CLM_NBR=BLXP.BLXP_CLCL_ID WHERE BLXP_ACCT_CAT='DRUG'  AND VEND_NM='ARGS' AND CLM_VER_NBR='00' AND PRDCT_BUS_CATEG_CD NOT IN ('0025')  AND BLXP_STS='3' AND BLXP.LOBD_ID='0006' AND CLM_TRANS_TYP_CD='P'  )BORFILESUBADJLIST WHERE ROW_NUM1 = 1 FETCH FIRST 6 ROWS ONLY